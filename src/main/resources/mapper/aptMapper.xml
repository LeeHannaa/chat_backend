<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
        "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="aptMapper">
    <resultMap id="AptMap" type="Apt">
        <id property="id" column="a_id"/>
        <result property="name" column="a_name"/>
        <result property="regDate" column="a_reg_date"/>

        <association property="user" javaType="User">
            <id property="id" column="u_id"/>
            <result property="name" column="u_name"/>
            <result property="fcmToken" column="u_fcm_token"/>
            <result property="regDate" column="u_reg_date"/>
        </association>
    </resultMap>

    <select id="findByUserId" parameterType="Long" resultMap="AptMap">
        SELECT
            a.id AS a_id,
            a.name AS a_name,
            a.reg_date AS a_reg_date,

            u.id AS u_id,
            u.name AS u_name
        FROM APT  a
                 JOIN user u ON a.user_id = u.id
        WHERE a.user_id = #{userId}
    </select>

    <select id="findAll" resultMap="AptMap">
        SELECT
            a.id AS a_id,
            a.name AS a_name,
            a.reg_date AS a_reg_date,

            u.id AS u_id,
            u.name AS u_name
        FROM APT  a
                 JOIN user u ON a.user_id = u.id
    </select>

    <select id="findById" parameterType="Long" resultMap="AptMap">
        SELECT
            a.id AS a_id,
            a.name AS a_name,
            a.reg_date AS a_reg_date,

            u.id AS u_id,
            u.name AS u_name
        FROM APT  a
                 JOIN user u ON a.user_id = u.id
        WHERE a.id = #{id}
    </select>
</mapper>
